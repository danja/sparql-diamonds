<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Wikidata things named 'Knot'</title>

    <script src="../lib/jquery-3.6.0.min.js"></script>

    <!-- template engine -->
    <script src="../lib/hogan-3.0.2.js"></script>

    <!-- time format utils -->
    <script src="../lib/moment.js"></script>

    <script src="../js/config.js"></script>
    <script src="../js/utils.js"></script>
    <script src="../js/sparql-connector.js"></script>

    <script type="text/javascript" language="javascript">

      var wikidataKnotSparql =
        '\n\
         PREFIX schema: <http://schema.org/>  \n\
         \n\
         SELECT DISTINCT ?target WHERE { \n\
         \n\
         ?target schema:name "Knot"@en . \n\
      }'

      var linkTemplate = "<li><a href='~{target}~'>~{target}~</a></li>";

      var endpoint = "https://query.wikidata.org/sparql?query=";

      var queryUrl =
        endpoint +
        encodeURIComponent(wikidataKnotSparql) +
        '&output=xml'

      function makeList (linkArray) {
        var list = '<ul>';

        for (var i = 0; i < linkArray.length; i++) {
          list += templater(linkTemplate, linkArray[i]);
        }
        
        return list+'</ul>';
      }

      $(function () {

        var doneCallback = function (json) {
          console.log('RESULT = ' + JSON.stringify(json));

        var list = makeList(json);

          console.log('list = ' + list);
          $('#targets').replaceWith(list)
        }

        // does ajax and conversts results xml-json
        getJsonForSparqlURL(queryUrl, doneCallback)
      })
    </script>
  </head>

  <body>
    Such things in Wikidata
    <table>
      <tr id="targets"></tr>
    </table>
  </body>
</html>
